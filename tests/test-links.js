import allsources from '../src/json/sources.json' assert {type: 'json'};

// By default, "sources", "tables", and "description" must be checked each time.
import archetypealchemist from '../src/json/archetypes_alchemist.json' assert {type: 'json'};
import archetypeantipaladin from '../src/json/archetypes_antipaladin.json' assert {type: 'json'};
import archetypearcanist from '../src/json/archetypes_arcanist.json' assert {type: 'json'};
import archetypebarbarian from '../src/json/archetypes_barbarian.json' assert {type: 'json'};
import archetypebard from '../src/json/archetypes_bard.json' assert {type: 'json'};
import archetypebloodrager from '../src/json/archetypes_bloodrager.json' assert {type: 'json'};
import archetypebrawler from '../src/json/archetypes_brawler.json' assert {type: 'json'};
import archetypecavalier from '../src/json/archetypes_cavalier.json' assert {type: 'json'};
import archetypecleric from '../src/json/archetypes_cleric.json' assert {type: 'json'};
import archetypecompanion from '../src/json/archetypes_COMPANION.json' assert {type: 'json'};
import archetypedruid from '../src/json/archetypes_druid.json' assert {type: 'json'};
import archetypefamiliar from '../src/json/archetypes_FAMILIAR.json' assert {type: 'json'};
import archetypefighter from '../src/json/archetypes_fighter.json' assert {type: 'json'};
import archetypegunslinger from '../src/json/archetypes_gunslinger.json' assert {type: 'json'};
import archetypehunter from '../src/json/archetypes_hunter.json' assert {type: 'json'};
import archetypeinquisitor from '../src/json/archetypes_inquisitor.json' assert {type: 'json'};
import archetypeinvestigator from '../src/json/archetypes_investigator.json' assert {type: 'json'};
import archetypekineticist from '../src/json/archetypes_kineticist.json' assert {type: 'json'};
import archetypemagus from '../src/json/archetypes_magus.json' assert {type: 'json'};
import archetypemedium from '../src/json/archetypes_medium.json' assert {type: 'json'};
import archetypemesmerist from '../src/json/archetypes_mesmerist.json' assert {type: 'json'};
import archetypemonk from '../src/json/archetypes_monk.json' assert {type: 'json'};
import archetypeunchained_monk from '../src/json/archetypes_monk_UC.json' assert {type: 'json'};
import archetypeninja from '../src/json/archetypes_ninja.json' assert {type: 'json'};
import archetypeoccultist from '../src/json/archetypes_occultist.json' assert {type: 'json'};
import archetypeoracle from '../src/json/archetypes_oracle.json' assert {type: 'json'};
import archetypepaladin from '../src/json/archetypes_paladin.json' assert {type: 'json'};
import archetypepsychic from '../src/json/archetypes_psychic.json' assert {type: 'json'};
import archetyperanger from '../src/json/archetypes_ranger.json' assert {type: 'json'};
import archetyperogue from '../src/json/archetypes_rogue.json' assert {type: 'json'};
import archetypesamurai from '../src/json/archetypes_samurai.json' assert {type: 'json'};
import archetypeshaman from '../src/json/archetypes_shaman.json' assert {type: 'json'};
import archetypeshifter from '../src/json/archetypes_shifter.json' assert {type: 'json'};
import archetypeskald from '../src/json/archetypes_skald.json' assert {type: 'json'};
import archetypeslayer from '../src/json/archetypes_slayer.json' assert {type: 'json'};
import archetypesorcerer from '../src/json/archetypes_sorcerer.json' assert {type: 'json'};
import archetypespiritualist from '../src/json/archetypes_spiritualist.json' assert {type: 'json'};
import archetypesummoner from '../src/json/archetypes_summoner.json' assert {type: 'json'};
import archetypeunchained_summoner from '../src/json/archetypes_summoner_UC.json' assert {type: 'json'};
import archetypeswashbuckler from '../src/json/archetypes_swashbuckler.json' assert {type: 'json'};
import archetypevigilante from '../src/json/archetypes_vigilante.json' assert {type: 'json'};
import archetypewarpriest from '../src/json/archetypes_warpriest.json' assert {type: 'json'};
import archetypewitch from '../src/json/archetypes_witch.json' assert {type: 'json'};
import archetypewizard from '../src/json/archetypes_wizard.json' assert {type: 'json'};
import arcaneschool from '../src/json/class_ability_arcane_schools.json' assert {type: 'json'};
import aspect from '../src/json/class_ability_aspects.json' assert {type: 'json'};
import bardicmasterpiece from '../src/json/class_ability_bardic_masterpieces.json' assert {type: 'json'};
import blessing from '../src/json/class_ability_blessings.json' assert {type: 'json'};
import bloodragerbloodline from '../src/json/class_ability_bloodrager_bloodlines.json' assert {type: 'json'};
import oraclecurse from '../src/json/class_ability_curses.json' assert {type: 'json'};
import discipline from '../src/json/class_ability_disciplines.json' assert {type: 'json'};
import domain from '../src/json/class_ability_domains.json' assert {type: 'json'};
import druidcompanion from '../src/json/class_ability_druid_companions.json' assert {type: 'json'};
import druiddomain from '../src/json/class_ability_druid_domains.json' assert {type: 'json'};
import emotionalfocus from '../src/json/class_ability_emotional_focus.json' assert {type: 'json'};
import exploit from '../src/json/class_ability_exploits.json' assert {type: 'json'};
import greaterexploit from '../src/json/class_ability_greater_exploits.json' assert {type: 'json'};
import hellknightorder from '../src/json/class_ability_hellknight_orders.json' assert {type: 'json'};
import implement from '../src/json/class_ability_implements.json' assert {type: 'json'};
import inquisition from '../src/json/class_ability_inquisitions.json' assert {type: 'json'};
import kinetic from '../src/json/class_ability_kinetic_talents.json' assert {type: 'json'};
import legendaryspirit from '../src/json/class_ability_legendary_spirits.json' assert {type: 'json'};
import magusarcana from '../src/json/class_ability_magus_arcana.json' assert {type: 'json'};
import mystery from '../src/json/class_ability_mysteries.json' assert {type: 'json'};
import oath from '../src/json/class_ability_oaths.json' assert {type: 'json'};
import order from '../src/json/class_ability_orders.json' assert {type: 'json'};
import outsiderspirit from '../src/json/class_ability_outsider_spirits.json' assert {type: 'json'};
import ragepower from '../src/json/class_ability_rage_powers.json' assert {type: 'json'};
import shamanspirit from '../src/json/class_ability_shaman_spirits.json' assert {type: 'json'};
import sorcererbloodline from '../src/json/class_ability_sorcerer_bloodlines.json' assert {type: 'json'};
import spirit from '../src/json/class_ability_spirits.json' assert {type: 'json'};
import stanceragepower from '../src/json/class_ability_stance_rage_powers.json' assert {type: 'json'};
import constructmod from '../src/json/construct_mods.json' assert {type: 'json'};
import corruption from '../src/json/corruptions.json' assert {type: 'json'};
import curse from '../src/json/curses.json' assert {type: 'json'};
import disease from '../src/json/diseases.json' assert {type: 'json'};
import drug from '../src/json/drugs.json' assert {type: 'json'};
import equipmentreagent from '../src/json/equipment_alchemical_reagents.json' assert {type: 'json'};
import equipmentarmor from '../src/json/equipment_armor.json' assert {type: 'json'};
import equipmentarmorenhancement from '../src/json/equipment_armor_enhancements.json' assert {type: 'json'};
import equipmentpoison from '../src/json/equipment_poisons.json' assert {type: 'json'};
import equipmentsiegeengine from '../src/json/equipment_siege_engines.json' assert {type: 'json'};
import equipmentmaterial from '../src/json/equipment_special_materials.json' assert {type: 'json'};
import equipmentspellbook from '../src/json/equipment_spellbooks.json' assert {type: 'json'};
import techarmor from '../src/json/equipment_tech_armor.json' assert {type: 'json'};
import techartifact from '../src/json/equipment_tech_artifacts.json' assert {type: 'json'};
import techcybertech from '../src/json/equipment_tech_cybertech.json' assert {type: 'json'};
import techmisc from '../src/json/equipment_tech_misc.json' assert {type: 'json'};
import techpharmaceutical from '../src/json/equipment_tech_pharmaceuticals.json' assert {type: 'json'};
import techweapon from '../src/json/equipment_tech_weapons.json' assert {type: 'json'};
import equipmentweapon from '../src/json/equipment_weapons.json' assert {type: 'json'};
import equipmentweaponenhancement from '../src/json/equipment_weapon_enhancements.json' assert {type: 'json'};
import haunt from '../src/json/haunts.json' assert {type: 'json'};
import infestation from '../src/json/infestations.json' assert {type: 'json'};
import madness from '../src/json/madness.json' assert {type: 'json'};
import magicaltar from '../src/json/magic_altar.json' assert {type: 'json'};
import magicarmor from '../src/json/magic_armor.json' assert {type: 'json'};
import magicimplant from '../src/json/magic_demonic_implants.json' assert {type: 'json'};
import magictalisman from '../src/json/magic_devil_talismans.json' assert {type: 'json'};
import magicaugmentation from '../src/json/magic_elemental_augmentations.json' assert {type: 'json'};
import magicenhancement from '../src/json/magic_enhancements.json' assert {type: 'json'};
import magicfavor from '../src/json/magic_favor.json' assert {type: 'json'};
import magicfleshcrafting from '../src/json/magic_fleshcrafting.json' assert {type: 'json'};
import magicgraft from '../src/json/magic_fungal_grafts.json' assert {type: 'json'};
import magicpoison from '../src/json/magic_infused_poisons.json' assert {type: 'json'};
import magicioun from '../src/json/magic_ioun_stones.json' assert {type: 'json'};
import magicfetish from '../src/json/magic_juju_fetishes.json' assert {type: 'json'};
import magicnecrograft from '../src/json/magic_necrografts.json' assert {type: 'json'};
import magicnecrotoxin from '../src/json/magic_necrotoxins.json' assert {type: 'json'};
import magicplant from '../src/json/magic_plant.json' assert {type: 'json'};
import magicrelic from '../src/json/magic_relics.json' assert {type: 'json'};
import magicring from '../src/json/magic_ring.json' assert {type: 'json'};
import magicrod from '../src/json/magic_rod.json' assert {type: 'json'};
import magicset from '../src/json/magic_set.json' assert {type: 'json'};
import magicpiercing from '../src/json/magic_shadow_piercings.json' assert {type: 'json'};
import magicstaff from '../src/json/magic_staff.json' assert {type: 'json'};
import magictattoo from '../src/json/magic_tattoo.json' assert {type: 'json'};
import magicthrone from '../src/json/magic_throne.json' assert {type: 'json'};
import subtype from '../src/json/monster_subtypes.json' assert {type: 'json'};
import mtype from '../src/json/monster_types.json' assert {type: 'json'};
import npcclass from '../src/json/npc_classes.json' assert {type: 'json'};
import sidekick from '../src/json/sidekicks.json' assert {type: 'json'};
import skill from '../src/json/skills.json' assert {type: 'json'};
import spelldef from '../src/json/spell_definitions.json' assert {type: 'json'};
import trap from '../src/json/traps.json' assert {type: 'json'};
import umr from '../src/json/umr.json' assert {type: 'json'};
import ability1 from '../src/json/class_abilities.json' assert {type: 'json'};
import ability2 from '../src/json/class_abilities2.json' assert {type: 'json'};
import ability3 from '../src/json/class_abilities3.json' assert {type: 'json'};
import classes1 from '../src/json/classes.json' assert {type: 'json'};
import classes2 from '../src/json/classes2.json' assert {type: 'json'};
import classes3 from '../src/json/classes3.json' assert {type: 'json'};
import classes4 from '../src/json/classes4.json' assert {type: 'json'};
import equipmentmisc1 from '../src/json/equipment_misc.json' assert {type: 'json'};
import equipmentmisc2 from '../src/json/equipment_misc2.json' assert {type: 'json'};
import equipmentmisc3 from '../src/json/equipment_misc3.json' assert {type: 'json'};
import faith1 from '../src/json/faiths.json' assert {type: 'json'};
import faith2 from '../src/json/faiths2.json' assert {type: 'json'};
import faith3 from '../src/json/faiths3.json' assert {type: 'json'};
import feat1 from '../src/json/feats.json' assert {type: 'json'};
import feat2 from '../src/json/feats2.json' assert {type: 'json'};
import feat3 from '../src/json/feats3.json' assert {type: 'json'};
import feat4 from '../src/json/feats4.json' assert {type: 'json'};
import feat5 from '../src/json/feats5.json' assert {type: 'json'};
import feat6 from '../src/json/feats6.json' assert {type: 'json'};
import feat7 from '../src/json/feats7.json' assert {type: 'json'};
import feat8 from '../src/json/feats8.json' assert {type: 'json'};
import magicartifact1 from '../src/json/magic_artifact.json' assert {type: 'json'};
import magicartifact2 from '../src/json/magic_artifact2.json' assert {type: 'json'};
import magicweapon1 from '../src/json/magic_weapon.json' assert {type: 'json'};
import magicweapon2 from '../src/json/magic_weapon2.json' assert {type: 'json'};
import magicwondrous1 from '../src/json/magic_wondrous.json' assert {type: 'json'};
import magicwondrous2 from '../src/json/magic_wondrous2.json' assert {type: 'json'};
import magicwondrous3 from '../src/json/magic_wondrous3.json' assert {type: 'json'};
import magicwondrous4 from '../src/json/magic_wondrous4.json' assert {type: 'json'};
import magicwondrous5 from '../src/json/magic_wondrous5.json' assert {type: 'json'};
import magicwondrous6 from '../src/json/magic_wondrous6.json' assert {type: 'json'};
import magicwondrous7 from '../src/json/magic_wondrous7.json' assert {type: 'json'};
import main1 from '../src/json/main.json' assert {type: 'json'};
import main2 from '../src/json/main02.json' assert {type: 'json'};
import main3 from '../src/json/main03.json' assert {type: 'json'};
import main4 from '../src/json/main04.json' assert {type: 'json'};
import main5 from '../src/json/main05.json' assert {type: 'json'};
import main6 from '../src/json/main06.json' assert {type: 'json'};
import main7 from '../src/json/main07.json' assert {type: 'json'};
import main8 from '../src/json/main08.json' assert {type: 'json'};
import main9 from '../src/json/main09.json' assert {type: 'json'};
import main10 from '../src/json/main10.json' assert {type: 'json'};
import main11 from '../src/json/main11.json' assert {type: 'json'};
import main12 from '../src/json/main12.json' assert {type: 'json'};
import main13 from '../src/json/main13.json' assert {type: 'json'};
import main14 from '../src/json/main14.json' assert {type: 'json'};
import main15 from '../src/json/main15.json' assert {type: 'json'};
import main16 from '../src/json/main16.json' assert {type: 'json'};
import main17 from '../src/json/main17.json' assert {type: 'json'};
import main18 from '../src/json/main18.json' assert {type: 'json'};
import main19 from '../src/json/main19.json' assert {type: 'json'};
import main20 from '../src/json/main20.json' assert {type: 'json'};
import main21 from '../src/json/main21.json' assert {type: 'json'};
import monster1 from '../src/json/monsters_unique.json' assert {type: 'json'};
import monster2 from '../src/json/monsters_unique2.json' assert {type: 'json'};
import monster3 from '../src/json/monsters_unique3.json' assert {type: 'json'};
import monster4 from '../src/json/mythic_monsters.json' assert {type: 'json'};
import monster5 from '../src/json/monsters01.json' assert {type: 'json'};
import monster6 from '../src/json/monsters02.json' assert {type: 'json'};
import monster7 from '../src/json/monsters03.json' assert {type: 'json'};
import monster8 from '../src/json/monsters04.json' assert {type: 'json'};
import monster9 from '../src/json/monsters05.json' assert {type: 'json'};
import monster10 from '../src/json/monsters06.json' assert {type: 'json'};
import monster11 from '../src/json/monsters07.json' assert {type: 'json'};
import monster12 from '../src/json/monsters08.json' assert {type: 'json'};
import monster13 from '../src/json/monsters09.json' assert {type: 'json'};
import monster14 from '../src/json/monsters10.json' assert {type: 'json'};
import monster15 from '../src/json/monsters11.json' assert {type: 'json'};
import monster16 from '../src/json/monsters12.json' assert {type: 'json'};
import monster17 from '../src/json/monsters13.json' assert {type: 'json'};
import monster18 from '../src/json/monsters14.json' assert {type: 'json'};
import monster19 from '../src/json/monsters15.json' assert {type: 'json'};
import monster20 from '../src/json/monsters16.json' assert {type: 'json'};
import monster21 from '../src/json/monsters17.json' assert {type: 'json'};
import monster22 from '../src/json/monsters18.json' assert {type: 'json'};
import monster23 from '../src/json/monsters19.json' assert {type: 'json'};
import monster24 from '../src/json/monsters20.json' assert {type: 'json'};
import monster25 from '../src/json/monsters21.json' assert {type: 'json'};
import monster26 from '../src/json/monsters22.json' assert {type: 'json'};
import monster27 from '../src/json/monsters23.json' assert {type: 'json'};
import monster28 from '../src/json/monsters24.json' assert {type: 'json'};
import monster29 from '../src/json/monsters25.json' assert {type: 'json'};
import template1 from '../src/json/monsters_templates.json' assert {type: 'json'};
import template2 from '../src/json/monsters_templates2.json' assert {type: 'json'};
import npc1 from '../src/json/npcs.json' assert {type: 'json'};
import npc2 from '../src/json/npcs2.json' assert {type: 'json'};
import npc3 from '../src/json/npcs3.json' assert {type: 'json'};
import npc4 from '../src/json/npcs4.json' assert {type: 'json'};
import prestigeclass1 from '../src/json/prestige_classes.json' assert {type: 'json'};
import prestigeclass2 from '../src/json/prestige_classes2.json' assert {type: 'json'};
import prestigeclass3 from '../src/json/prestige_classes3.json' assert {type: 'json'};
import race1 from '../src/json/races.json' assert {type: 'json'};
import race2 from '../src/json/races2.json' assert {type: 'json'};
import rule1 from '../src/json/rules.json' assert {type: 'json'};
import rule2 from '../src/json/rules2.json' assert {type: 'json'};
import rule3 from '../src/json/rules3.json' assert {type: 'json'};
import rule4 from '../src/json/rules4.json' assert {type: 'json'};
import rule5 from '../src/json/rules5.json' assert {type: 'json'};
import rule6 from '../src/json/rules6.json' assert {type: 'json'};
import rule7 from '../src/json/rules7.json' assert {type: 'json'};
import rule8 from '../src/json/rules8.json' assert {type: 'json'};
import rule9 from '../src/json/rules9.json' assert {type: 'json'};
import rule10 from '../src/json/rules10.json' assert {type: 'json'};
import rule11 from '../src/json/rules11.json' assert {type: 'json'};
import rule12 from '../src/json/rules12.json' assert {type: 'json'};
import rule13 from '../src/json/rules13.json' assert {type: 'json'};
import rule14 from '../src/json/rules14.json' assert {type: 'json'};
import rule15 from '../src/json/rules15.json' assert {type: 'json'};
import rule16 from '../src/json/rules16.json' assert {type: 'json'};
import rule17 from '../src/json/rules17.json' assert {type: 'json'};
import rule18 from '../src/json/rules18.json' assert {type: 'json'};
import spell1 from '../src/json/spells.json' assert {type: 'json'};
import spell2 from '../src/json/spells2.json' assert {type: 'json'};
import spell3 from '../src/json/spells3.json' assert {type: 'json'};
import spell4 from '../src/json/spells4.json' assert {type: 'json'};
import spell5 from '../src/json/spells5.json' assert {type: 'json'};
import spell6 from '../src/json/spells6.json' assert {type: 'json'};
import spell7 from '../src/json/spells7.json' assert {type: 'json'};
import spell8 from '../src/json/spells8.json' assert {type: 'json'};
import spell9 from '../src/json/spells9.json' assert {type: 'json'};
import spell10 from '../src/json/spells10.json' assert {type: 'json'};
import spell11 from '../src/json/spells11.json' assert {type: 'json'};
import spell12 from '../src/json/occult_rituals.json' assert {type: 'json'};
import trait1 from '../src/json/traits.json' assert {type: 'json'};
import trait2 from '../src/json/traits2.json' assert {type: 'json'};
import trait3 from '../src/json/traits3.json' assert {type: 'json'};
// The file below checks inside: sources, description, tables, members, mythic_members
import family from '../src/json/monsters_families.json' assert {type: 'json'};

const ability = {...ability1, ...ability2, ...ability3};
const equipmentmisc = {...equipmentmisc1, ...equipmentmisc2, ...equipmentmisc3};
const faith = {...faith1, ...faith2, ...faith3};
const feats = {...feat1, ...feat2, ...feat3, ...feat4, ...feat5, ...feat6, ...feat7, ...feat8};
const magicartifact = {...magicartifact1, ...magicartifact2};
const magicweapon = {...magicweapon1, ...magicweapon2};
const magicwondrous = {...magicwondrous1, ...magicwondrous2, ...magicwondrous3, ...magicwondrous4, ...magicwondrous5, ...magicwondrous6, ...magicwondrous7};
const monster = {...monster1, ...monster2, ...monster3, ...monster4, ...monster5, ...monster6, ...monster7, ...monster8, ...monster9, ...monster10, ...monster11, ...monster12, ...monster13, ...monster14, ...monster15, ...monster16, ...monster17, ...monster18, ...monster19, ...monster20, ...monster21, ...monster22, ...monster23, ...monster24, ...monster25, ...monster26, ...monster27, ...monster28,... monster29};
const main = {...main1, ...main2, ...main3, ...main4, ...main5, ...main6, ...main7, ...main8, ...main9, ...main10, ...main11, ...main12, ...main13, ...main14, ...main15, ...main16, ...main17, ...main18, ...main19, ...main20, ...main21};
const template = {...template1, ...template2};
const rule = {...rule1, ...rule2, ...rule3, ...rule4, ...rule5, ...rule6, ...rule7, ...rule8, ...rule9, ...rule10, ...rule11, ...rule12, ...rule13, ...rule14, ...rule15, ...rule16, ...rule17, ...rule18};
const spell = {...spell1, ...spell2, ...spell3, ...spell4, ...spell5, ...spell6, ...spell7, ...spell8, ...spell9, ...spell10, ...spell11, ...spell12};
const npc = {...npc1, ...npc2, ...npc3, ...npc4};
const prestigeclass = {...prestigeclass1, ...prestigeclass2, ...prestigeclass3};
const race = {...race1, ...race2};
const trait = {...trait1, ...trait2, ...trait3};

const classes = {...classes1, ...classes2, ...classes3, ...classes4};

const all = [
	["archetype-alchemist", archetypealchemist], ["archetype-antipaladin", archetypeantipaladin],
	["archetype-arcanist", archetypearcanist], ["archetype-barbarian", archetypebarbarian],
	["archetype-bard", archetypebard], ["archetype-bloodrager", archetypebloodrager],
	["archetype-brawler", archetypebrawler], ["archetype-cavalier", archetypecavalier],
	["archetype-cleric", archetypecleric], ["archetype-companion", archetypecompanion],
	["archetype-druid", archetypedruid], ["archetype-familiar", archetypefamiliar],
	["archetype-fighter", archetypefighter], ["archetype-gunslinger", archetypegunslinger],
	["archetype-hunter", archetypehunter], ["archetype-inquisitor", archetypeinquisitor],
	["archetype-investigator", archetypeinvestigator], ["archetype-kineticist", archetypekineticist],
	["archetype-magus", archetypemagus], ["archetype-medium", archetypemedium],
	["archetype-mesmerist", archetypemesmerist], ["archetype-monk", archetypemonk],
	["archetype-unchained_monk", archetypeunchained_monk], ["archetype-ninja", archetypeninja],
	["archetype-occultist", archetypeoccultist], ["archetype-oracle", archetypeoracle],
	["archetype-paladin", archetypepaladin], ["archetype-psychic", archetypepsychic],
	["archetype-ranger", archetyperanger], ["archetype-rogue", archetyperogue],
	["archetype-samurai", archetypesamurai], ["archetype-shaman", archetypeshaman],
	["archetype-shifter", archetypeshifter], ["archetype-skald", archetypeskald],
	["archetype-slayer", archetypeslayer], ["archetype-sorcerer", archetypesorcerer],
	["archetype-spiritualist", archetypespiritualist], ["archetype-summoner", archetypesummoner],
	["archetype-unchained_summoner", archetypeunchained_summoner],
	["archetype-swashbuckler", archetypeswashbuckler], ["archetype-vigilante", archetypevigilante],
	["archetype-warpriest", archetypewarpriest], ["archetype-witch", archetypewitch],
	["archetype-wizard", archetypewizard], ["arcaneschool", arcaneschool], ["aspect", aspect],
	["bardicmasterpiece", bardicmasterpiece], ["blessing", blessing],
	["bloodragerbloodline", bloodragerbloodline], ["oraclecurse", oraclecurse],
	["discipline", discipline], ["domain", domain], ["druidcompanion", druidcompanion],
	["druiddomain", druiddomain], ["emotionalfocus", emotionalfocus], ["exploit", exploit],
	["greaterexploit", greaterexploit], ["hellknightorder", hellknightorder],
	["implement", implement], ["inquisition", inquisition], ["kinetic", kinetic],
	["legendaryspirit", legendaryspirit], ["magusarcana", magusarcana], ["mystery", mystery],
	["oath", oath], ["order", order], ["ragepower", ragepower], ["shamanspirit", shamanspirit],
	["sorcererbloodline", sorcererbloodline], ["spirit", spirit],
	["stanceragepower", stanceragepower], ["constructmod", constructmod],
	["corruption", corruption], ["curse", curse], ["disease", disease], ["drug", drug],
	["equipment-reagent", equipmentreagent], ["equipment-armor", equipmentarmor],
	["equipment-armorenhancement", equipmentarmorenhancement],
	["equipment-poison", equipmentpoison], ["equipment-siegeengine", equipmentsiegeengine],
	["equipment-material", equipmentmaterial], ["equipment-spellbook", equipmentspellbook],
	["tech-armor", techarmor], ["tech-artifact", techartifact], ["tech-cybertech", techcybertech],
	["tech-misc", techmisc], ["tech-pharmaceutical", techpharmaceutical],
	["tech-weapon", techweapon], ["equipment-weapon", equipmentweapon],
	["equipment-weaponenhancement", equipmentweaponenhancement], ["haunt", haunt],
	["infestation", infestation], ["madness", madness], ["magic-altar", magicaltar],
	["magic-armor", magicarmor], ["magic-implant", magicimplant], ["magic-talisman", magictalisman],
	["magic-augmentation", magicaugmentation], ["magic-enhancement", magicenhancement],
	["magic-favor", magicfavor], ["magic-fleshcrafting", magicfleshcrafting],
	["magic-graft", magicgraft], ["magic-poison", magicpoison], ["magic-ioun", magicioun],
	["magic-fetish", magicfetish], ["magic-necrograft", magicnecrograft],
	["magic-necrotoxin", magicnecrotoxin], ["magic-plant", magicplant], ["magic-relic", magicrelic],
	["magic-ring", magicring], ["magic-rod", magicrod], ["magic-set", magicset],
	["magic-piercing", magicpiercing], ["magic-staff", magicstaff], ["magic-tattoo", magictattoo],
	["magic-throne", magicthrone], ["subtype", subtype], ["type", mtype], ["npcclass", npcclass],
	["sidekick", sidekick], ["skill", skill], ["spelldef", spelldef], ["trap", trap],
	["umr", umr], ["outsiderspirit", outsiderspirit], ["ability", ability],
	["equipment-misc", equipmentmisc], ["faith", faith], ["feat", feats],
	["magic-artifact", magicartifact], ["magic-weapon", magicweapon],
	["magic-wondrous", magicwondrous], ["monster", monster], ["template", template],
	["rule", rule], ["spell", spell], ["npc", npc], ["prestigeclass", prestigeclass],
	["race", race], ["trait", trait], ["class", classes],
	// these final two have a third array member
	["main", main, "arraydescs"], ["family", family, "memberships"]
];

const known_props = {};

all.forEach(([link, object]) => {
	// Create master list of links
	known_props[link] = {};
	Object.keys(object).forEach(key => (known_props[link][key] = true));
});

// Ex:
//    known_props.race.ratfolk = true
//    known_props.race.rat = undefined


const testLinks = () => {
	const msg = [ "\n...beginning link validation tests\n" ];
	let found = false;
	all.forEach(([link, object, special]) => {
		// validate links
		// `invalid links in ${link} files:`
		const invalid = [];
		Object.keys(object).forEach(prop => {
			const {sources, tables, description, members, mythic_members} = object[prop];
			if(sources !== undefined) {
				if(!sources || !Array.isArray(sources)) {
					msg.push(`\tINVALID ${prop}.sources`);
				} else {
					sources.every(s => {
						if(typeof s !== "string") {
							msg.push(`\tINVALID entry in ${prop}.sources`);
							return false;
						} else if (!allsources[s]) {
							msg.push(`\tINVALID source "${s}" in ${prop}.sources`);
						}
						return true;
					});
				}
			}
			const TESTING = description ? (Array.isArray(description) ? [...description] : [description]) : [];
			switch(special) {
				case "arraydescs":
					const hold = [];
					while(TESTING.length > 0) {
						const line = TESTING.shift();
						if(Array.isArray(line)) {
							hold.push(...line);
						} else {
							const m = line.match(/^#{2,6} ([^ ]+)/);
							if(m) {
								const link = m[1];
								if((link.indexOf("/") === -1) && link !== "about") {
									msg.push(`\tPOSSIBLE bad main-page link: "${link}"`);
								} else {
									hold.push(`[main-page link](${link})`);
								}
							}
						}
					}
					TESTING.push(...hold);
					break;
				case "memberships":
					if(members) {
						if(!Array.isArray(members)) {
							msg.push(`\tINVALID ${link}.members`);
						} else {
							TESTING.push(...members);
						}
					}
					if(mythic_members) {
						if(!Array.isArray(mythic_members)) {
							msg.push(`\tINVALID ${link}.mythic_members`);
						} else {
							TESTING.push(...mythic_members);
						}
					}
			}
			const z = (tables || []);
			if(z && !Array.isArray(z)) {
				console.log(">>"+link+">>"+JSON.stringify(z));
			}
			(tables || []).forEach(table => {
				const ripples = table.ripples || [];
				table.data.forEach(row => {
					TESTING.push(...row.map((bit, i) => {
						if(Array.isArray(bit)) {
							if(bit.length === 3) {
								return `[](${bit[1]})`;
							} else if (ripples.indexOf(i) > -1) {
								return `[](${bit[0]})`;
							}
							const temp = bit[1];
							return typeof temp === "string" ? temp : null;
						}
						return typeof bit === "string" ? bit : null;
					}).filter(bit => bit !== null)); //test new tables
				});
			});
			TESTING.forEach(line => {
				let temp = line;
				let m = false;
				while(m = temp.match(/\]\(\/?([^)]+)\/([^)/]+)\)(.*$)/)) {
					// Checking [Links](whatever/link)
					if(m) {
						if(m[1] === "source") {
							if(!allsources[m[2]]) {
								invalid.push(m[1] + "/" + m[2]);
							}
						} else if (m[1].match(/^http/)) {
							// Skip
						} else if(!known_props[m[1]] || !known_props[m[1]][m[2]]) {
							invalid.push(m[1] + "/" + m[2]);
						}
						temp = m[3];
					}
				}
				temp = line;
				while(m = temp.match(/\{SOURCE ([^}]+)\}(.*$)/)) {
					// Testing {SOURCE Title/##}
					if (m) {
						m[1].split(/;/).forEach(bit => {
							const xx = bit.match(/([^/]+)(\/[0-9]*)?$/);
							if(!xx) {
								msg.push(`\t{SOURCE} error [${bit}]`);
							} else if (!allsources[xx[1]]) {
								invalid.push("{SOURCE " + xx[1] + "}");
							}
						});
						temp = m[2];
					}
				}
				temp = line;
				while(m = temp.match(/\{([-a-z]+)\/([^}]+?)(?:\/[^}]+)?\}(.*$)/)) {
					// Testing {link/Plain Text}
					if (m) {
						const [x, protocol, title, remainder] = m;
						const final = title.toLowerCase().replace(/ /g, "_").replace(/[^-a-z_0-9]/g, "");
						const potential = `{${protocol}/${title}}`;
						if(protocol === "source") {
							if(!allsources[final]) {
								invalid.push(potential);
							}
						} else if(!known_props[protocol] || !known_props[protocol][final]) {
							invalid.push(potential);
						}
						temp = remainder;
					}
				}
			});
		});
		(invalid.length > 0) && msg.push(`\tInvalid links in ${link} files:`, ...invalid.map(x => `\t\t${x}`));
		msg.length > 1 && (found = true);
	});
	return [found, "valid links", [...msg, "", "-- Done.\n\n"]];
}

export default testLinks;
